(()=>{"use strict";let n={session_id:crypto.randomUUID(),actions:{}},t=!1;async function e(){const t={prompt:JSON.stringify(n,null,2)};await fetch("http://localhost:8888/text_json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((n=>n.blob())).then((n=>{const t=window.URL.createObjectURL(n),e=document.createElement("a");e.href=t,e.download="manual.txt",document.body.appendChild(e),e.click(),e.remove()}))}function o(){t&&e(),t=!t}window.downloadLogs=function(){const t=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),e=URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download="session-log.json",o.click(),URL.revokeObjectURL(e)},window.sendLogs=e,window.startLoging=o,document.addEventListener("click",(e=>{if(!t)return null;const o=e.composedPath?.()||[],a=e.target;let i;for(let n=0;n<o.length;n++){let t=o[n];"BUTTON"===t.tagName&&(i=t.getAttribute("aria-lable")),"INPUT"===t.tagName&&(i=t.getAttribute("placeholder"))}console.log("Click:",{tag:a.tagName,id:a.id,class:a.className,text:a.innerText?.slice(0,100),path:o.map((n=>n.tagName)).join(" > "),hint:i}),n.actions[(new Date).toISOString()]={Click:{tag:a.tagName,id:a.id,class:a.className,text:a.innerText?.slice(0,100),path:o.map((n=>n.tagName)).join(" > "),hint:i}}}));const a=XMLHttpRequest.prototype.open,i=XMLHttpRequest.prototype.send;function d(n){return n?n.nodeType===Node.TEXT_NODE?{type:"text",content:n.textContent}:n.nodeType===Node.ELEMENT_NODE?{tag:n.tagName,id:n.id,class:n.className,attributes:[...n.attributes].map((n=>({name:n.name,value:n.value})))}:{type:"other",nodeType:n.nodeType}:null}XMLHttpRequest.prototype.open=function(n,e){return t?(this._url=e,this._method=n,a.apply(this,arguments)):a.apply(this,arguments)},XMLHttpRequest.prototype.send=function(e){return t?(console.log("XHR:",{url:this._url,method:this._method,body:e}),n.actions[(new Date).toISOString()]={XHR:{resource:this._url,method:this._method,body:e}},i.apply(this,arguments)):i.apply(this,arguments)},new MutationObserver((e=>{if(!t)return null;for(const t of e){const e={type:t.type,target:d(t.target),addedNodes:[...t.addedNodes].map(d),removedNodes:[...t.removedNodes].map(d),attributeName:t.attributeName,oldValue:t.oldValue},o=(new Date).toISOString();n.actions||(n.actions={}),n.actions[o]={DOMChanged:e},console.log("DOM changed:",e)}})).observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("popstate",(()=>{console.log("Navigated to:",window.location.href)})),window.addEventListener("load",(()=>{console.log("Page loaded:",window.location.href)})),function(){const n=(n,t={},e=[])=>{const o=document.createElement(n);return Object.entries(t).forEach((([n,t])=>{"class"===n?o.className=t:"text"===n?o.textContent=t:n.startsWith("on")?o.addEventListener(n.slice(2).toLowerCase(),t):o.setAttribute(n,t)})),e.forEach((n=>o.appendChild(n))),o},t=()=>{(()=>{const n=document.createElement("style");n.innerHTML="\n    .flowconnect-toggle {\n      position: fixed;\n      bottom: 24px;\n      right: 24px;\n      width: 48px;\n      height: 48px;\n      border-radius: 9999px;\n      background: white;\n      border: 1px solid #d1d5db;\n      box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      z-index: 9999;\n    }\n    .flowconnect-menu {\n      position: fixed;\n      bottom: 80px;\n      right: 24px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      z-index: 9999;\n    }\n    .flowconnect-btn {\n      border-radius: 9999px;\n      background: white;\n      color: #374151;\n      padding: 10px 16px;\n      font-size: 14px;\n      font-weight: 500;\n      border: 1px solid #d1d5db;\n      box-shadow: 0 3px 6px rgba(0,0,0,0.1);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      transition: background 0.2s;\n    }\n    .flowconnect-btn:hover {\n      background: #f3f4f6;\n    }\n    .flowconnect-dialog {\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      width: 360px;\n      background: white;\n      border-radius: 10px;\n      border: 1px solid #d1d5db;\n      box-shadow: 0 8px 24px rgba(0,0,0,0.15);\n      transform: translate(-50%, -50%);\n      padding: 24px;\n      z-index: 9999;\n    }\n    .flowconnect-dialog input {\n      width: 100%;\n      padding: 10px;\n      margin-top: 12px;\n      border: 1px solid #d1d5db;\n      border-radius: 6px;\n      font-size: 14px;\n    }\n    .flowconnect-indicator {\n      position: fixed;\n      top: 16px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: white;\n      color: #1f2937;\n      border: 1px solid #d1d5db;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n      width: 280px;\n      padding: 16px;\n      z-index: 9999;\n    }\n    .flowconnect-progress {\n      margin-top: 10px;\n      height: 6px;\n      background: #e5e7eb;\n      border-radius: 9999px;\n      overflow: hidden;\n    }\n    .flowconnect-progress-bar {\n      height: 100%;\n      width: 0%;\n      background: #ef4444;\n      transition: width 1s linear;\n    }\n    .flowconnect-stop-btn {\n      margin-top: 12px;\n      width: 100%;\n      background: #ef4444;\n      color: white;\n      font-weight: 500;\n      border: none;\n      padding: 8px;\n      border-radius: 8px;\n      cursor: pointer;\n    }\n  ",document.head.appendChild(n)})();const t=n("div",{class:"flowconnect-toggle"},[n("img",{src:"https://cdn.jsdelivr.net/gh/MykhailoShushmanStartupSoft/codia_sdk@master/images/b141ea3a-509d-46f2-a7ad-23234114b19c.png",width:24,height:24})]),e=n("div",{class:"flowconnect-menu",style:"display: none;"}),a=n("button",{class:"flowconnect-btn",onclick:()=>h()},[n("span",{text:"🎙️"}),n("span",{text:"Record Flow"})]),i=n("button",{class:"flowconnect-btn",onclick:()=>alert("Configure clicked")},[n("span",{text:"⚙️"}),n("span",{text:"Configure"})]),d=n("button",{class:"flowconnect-btn",onclick:()=>{e.remove(),t.remove(),s?.remove()}},[n("span",{text:"❌"}),n("span",{text:"Exit FlowConnect"})]);e.appendChild(a),e.appendChild(i),e.appendChild(d),document.body.appendChild(t),document.body.appendChild(e),t.addEventListener("click",(()=>{e.style.display="none"===e.style.display?"flex":"none"}));let r,s,c,l,p,u=0;const h=()=>{r=n("div",{class:"flowconnect-dialog"},[n("h3",{text:"Name Your Flow Recording"}),n("input",{id:"flow-name",placeholder:"e.g., Checkout Experience"}),n("div",{style:"margin-top: 16px; text-align: right;"},[n("button",{class:"flowconnect-btn",text:"Cancel",onclick:()=>r.remove()}),n("button",{class:"flowconnect-btn",text:"Start",style:"margin-left: 8px; background: #3b82f6; color: white;",onclick:()=>{const n=r.querySelector("#flow-name").value.trim();n&&(r.remove(),g(n),o())}})])]),document.body.appendChild(r)},g=t=>{u=0,c=n("span",{text:"00:00"}),l=n("div",{class:"flowconnect-progress-bar"}),s=n("div",{class:"flowconnect-indicator"},[n("div",{},[n("strong",{text:t}),n("span",{style:"float: right;"},[c])]),n("div",{class:"flowconnect-progress"},[l]),n("button",{class:"flowconnect-stop-btn",text:"Stop Recording",onclick:()=>x()})]),document.body.appendChild(s),p=setInterval((()=>{u++;const n=String(Math.floor(u/60)).padStart(2,"0"),t=String(u%60).padStart(2,"0");c.textContent=`${n}:${t}`,l.style.width=`${Math.min(u,100)}%`}),1e3)},x=()=>{clearInterval(p),s.remove(),o(),alert("Recording stopped.")}};(async()=>{try{const n=new URLSearchParams(window.location.search).get("user_id"),t=document.currentScript,e=new URL(t.src),o=new URLSearchParams(e.search).get("uuid");if(console.log("user_id: "+n+" uuid: "+o),!n||!o)return console.warn("Missing user_id or uuid"),!1;const a=await fetch("http://codia-api.startupsoft.org:8888/api/customers/sdk/check-session/",{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({uuid:o,customer_id:n})}),i=await a.json();return console.log(i.is_active),!0===i.is_active}catch(n){return console.error("Error in check_user:",n),!1}})().then((n=>{n&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t())}))}()})();